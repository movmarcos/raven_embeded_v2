create or replace view RAVEN.VW_METADATA_OVERALL_CONFIG AS
SELECT 
	FL.SOURCE_SYSTEM_CODE, 
	FL.SOURCE_FEED_CODE, 
	FL.STAGE_NAME, 
	FL.SOURCE_FILE_PATH, 
	FL.SOURCE_FILE_NAME_PATTERN, 
	FL.DESTINATION_SCHEMA_NAME, 
	FL.DESTINATION_TABLE_NAME, 
	FL.DESTINATION_FULL_TABLE_NAME, 
	IFNULL(FL.IS_ENABLED, FALSE) SOURCE_FILE_IS_ENABLED, 
	FL.DELETE_STAGE_BY_FILE_NAME, 
	FL.FILE_FORMAT, 
	FL.DATE_INPUT_FORMAT, 
	FL.TIMESTAMP_INPUT_FORMAT, 
	FL.SKIP_ROW_ON_ERROR, 
	FL.SOURCE_FIELD_NAME, 
	FL.TARGET_FIELD_NAME, 
	FL.FIELD_ORDINAL, 
	FL.DATA_TYPE_NAME, 
	FL.DATA_TYPE_LENGTH, 
	FL.DATA_TYPE_PRECISION, 
	FL.DATA_TYPE_SCALE, 
	FL.DATA_TYPE_SIZE, 
	FL.SNOWPARK_DATA_TYPE, 
	FL.IS_IN_SOURCE, 
	FL.IS_IN_TARGET, 
	FL.IS_DELETED_FIELD, 
	FL.DERIVED_EXPRESSION, 
	FL.CURRENT_DATABASE_NAME, 
	FL.ENVIRONMENT,
	IFNULL( SP.DATASET_NAME, 'N/A') 		AS DATASET_NAME,
	IFNULL( SP.CONTAINER_NAME, 'N/A') 		AS CONTAINER_NAME,
	IFNULL( SP.FILE_PATH, 'N/A') 			AS FILE_PATH,
	IFNULL( SP.FILE_NAME, 'N/A') 			AS FILE_NAME,
	SPLIT_PART(SP.FILE_NAME,'.',-1) 		AS FILE_EXTENSION,
	IFNULL( SP.IS_TRIGGER_FILE, FALSE) 		AS IS_TRIGGER_FILE,
	IFNULL( SP.IS_CLOUD_COPY, FALSE) 		AS IS_CLOUD_COPY,
	UPPER('TASK_' || SPLIT_PART(FL.STAGE_NAME,'.',-1) || '_' || FILE_EXTENSION) AS TASK_LIST_NAME,
	IFNULL(SP.IS_ENABLED, FALSE) STAGE_ME_PARAMETERS_IS_ENABLED, 
	SP.LAST_MODIFIED,
	SP.FIRST_TIME_INSERTED
FROM 
	RAVEN.VW_METADATA_SOURCE_FILE_AND_FIELD FL
FULL JOIN 
	RAVEN.METADATA_STAGE_ME_PARAMETERS SP ON FL.SOURCE_SYSTEM_CODE = SP.SOURCE_SYSTEM_CODE 
										 AND FL.SOURCE_FEED_CODE = SP.SOURCE_FEED_CODE;
